var TwaInitDataValidation=function(e,t){"use strict";return e.validate=function(e,r,a){void 0===a&&(a={});var n="string"==typeof e?new URLSearchParams(e):e,i=new Date(0),o="",h=[];if(n.forEach((function(e,t){if("hash"!==t){if("auth_date"===t){var r=parseInt(e);if(Number.isNaN(r))throw new TypeError('"auth_date" should present integer.');i=new Date(1e3*r)}h.push("".concat(t,"=").concat(e))}else o=e})),0===o.length)throw new Error('"hash" is empty or not found.');if(0===i.getTime())throw new Error('"auth_date" is empty or not found.');var f=a.expiresIn,s=void 0===f?86400:f;if(s>0&&i.getTime()+1e3*s<(new Date).getTime())throw new Error("Init data expired.");h.sort();var w=t.algo.HMAC.create(t.algo.SHA256,"WebAppData").finalize(r);if(t.algo.HMAC.create(t.algo.SHA256,w).finalize(h.join("\n")).toString()!==o)throw new Error("Sign invalid")},e}({},CryptoJS);
