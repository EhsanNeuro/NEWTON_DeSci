import{algo as e}from"crypto-js";function r(r,t,n){void 0===n&&(n={});var a="string"==typeof r?new URLSearchParams(r):r,i=new Date(0),o="",h=[];if(a.forEach((function(e,r){if("hash"!==r){if("auth_date"===r){var t=parseInt(e);if(Number.isNaN(t))throw new TypeError('"auth_date" should present integer.');i=new Date(1e3*t)}h.push("".concat(r,"=").concat(e))}else o=e})),0===o.length)throw new Error('"hash" is empty or not found.');if(0===i.getTime())throw new Error('"auth_date" is empty or not found.');var f=n.expiresIn,s=void 0===f?86400:f;if(s>0&&i.getTime()+1e3*s<(new Date).getTime())throw new Error("Init data expired.");h.sort();var p=e.HMAC.create(e.SHA256,"WebAppData").finalize(t);if(e.HMAC.create(e.SHA256,p).finalize(h.join("\n")).toString()!==o)throw new Error("Sign invalid")}export{r as validate};
