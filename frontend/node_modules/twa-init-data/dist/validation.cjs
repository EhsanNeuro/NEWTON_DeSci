"use strict";var e=require("crypto-js");exports.validate=function(r,t,a){void 0===a&&(a={});var i="string"==typeof r?new URLSearchParams(r):r,o=new Date(0),n="",s=[];if(i.forEach((function(e,r){if("hash"!==r){if("auth_date"===r){var t=parseInt(e);if(Number.isNaN(t))throw new TypeError('"auth_date" should present integer.');o=new Date(1e3*t)}s.push("".concat(r,"=").concat(e))}else n=e})),0===n.length)throw new Error('"hash" is empty or not found.');if(0===o.getTime())throw new Error('"auth_date" is empty or not found.');var h=a.expiresIn,f=void 0===h?86400:h;if(f>0&&o.getTime()+1e3*f<(new Date).getTime())throw new Error("Init data expired.");s.sort();var w=e.algo.HMAC.create(e.algo.SHA256,"WebAppData").finalize(t);if(e.algo.HMAC.create(e.algo.SHA256,w).finalize(s.join("\n")).toString()!==n)throw new Error("Sign invalid")};
